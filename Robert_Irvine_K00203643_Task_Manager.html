<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<title>Task Manager</title>
<link href="styles.css" rel="stylesheet" type="text/css" />
<style type="text/css">
</style>
</head>

<body>
<div id="container">

<div id="inputContainer">

  <p>Description:
  <input type="text" id="Description">
  </p>
  <p>Priority: 
    <input type="number" id="Priority">
  </p>
  <p>Date: 
    <input type="date" id="date">
  </p>

</div>

<p>
</p>
<button class="btn btn-success btn-block" id="submit_btn">Submit</button>
<br />

<table class="table table-striped" align="center" id="myTable1" border="1" cellpadding="0">
  <thead>
    <tr>
      <th><button class="btn btn-info btn-block" id="taskTab">Task ID</button></th>
      <th><button class="btn btn-info btn-block" id="descTab">Description</button></th>
      <th><button class="btn btn-info btn-block" id="priorTab">Priority</button></th>
      <th><button class="btn btn-info btn-block" id="dateTab">Date</button></th>
      <th> <span class="glyphicon glyphicon-sort"></span></p> </th>
    </tr>
  </thead>
  <tbody id="myTable">
  </tbody>
</table>

</div>

<script>

var myTasks = new Array();
var randomID= 1;

window.onload=startUp;

function startUp() {
	
	if(typeof(window.localStorage) != 'undefined'){ 
		if (localStorage.getItem("taskStorage") != null) { 

		myTasks=JSON.parse(localStorage.getItem("taskStorage"));
		makeTable();
	}}
	
	document.getElementById("submit_btn").onclick=function() {
		var taskVar = randomID++;
		var descVar = document.getElementById("Description").value;
		var priorVar = document.getElementById("Priority").value;
		var dateVar = document.getElementById("date").value;
		var taskObject = {taskI:taskVar, taskDesc:descVar, taskPrior:priorVar, taskDate:dateVar};
		myTasks.push(taskObject);
		
		var table = document.getElementById("myTable");
    	var row = table.insertRow(0);
    	var cell1 = row.insertCell(0);
    	var cell2 = row.insertCell(1);
		var cell3 = row.insertCell(2);
    	var cell4 = row.insertCell(3);
		var cell5 = row.insertCell(4);
    	cell1.innerHTML = taskVar;
    	cell2.innerHTML = descVar;
		cell3.innerHTML = priorVar;
    	cell4.innerHTML = dateVar;
		cell5.innerHTML = '<input type="button" class="btn btn-danger" value = "Delete" onClick="Javacsript:deleteRow(this)">';
		
		var keyinput = "taskStorage";
		
		if(typeof(window.localStorage) != 'undefined'){ 			                 
		window.localStorage.setItem(keyinput,JSON.stringify(myTasks)); 	} 	
		else{ 		
		alert("window.localStorage, not defined"); 	
	}
	}
	
	
	document.getElementById("taskTab").onclick=function() {
		myTasks.sort(function(a, b){
    	if(a.taskI < b.taskI) return -1;
    	if(a.taskI > b.taskI) return 1;
    	return 0;
		})
		makeTable();
	}
	document.getElementById("descTab").onclick=function() {
		myTasks.sort(function(a, b){
    	if(a.taskDesc < b.taskDesc) return -1;
    	if(a.taskDesc > b.taskDesc) return 1;
    	return 0;
		})
		makeTable();
	}
	document.getElementById("priorTab").onclick=function() {
		myTasks.sort(function(a, b){
    	
    	return a.taskPrior-b.taskPrior;
		})
		makeTable();
	}
	document.getElementById("dateTab").onclick=function() {
		myTasks.sort(function(a, b){
    	
    	return new Date(a.taskDate) - new Date(b.taskDate);
		})
		makeTable();
	}
}

function deleteRow(selectedRow) {
      
    var index = selectedRow.parentNode.parentNode.rowIndex;
    var table = document.getElementById("myTable1");
    table.deleteRow(index);
	myTasks.splice(index-1, 1);
	
	var keyinput = "taskStorage";
		
		if(typeof(window.localStorage) != 'undefined'){ 			                 
		window.localStorage.setItem(keyinput,JSON.stringify(myTasks)); 	} 	
		else{ 		
		alert("window.localStorage, not defined"); 	
	}
}

function makeTable(){
	var elmtTable = document.getElementById('myTable');
	var tableRows = elmtTable.getElementsByTagName('tr');
	var rowCount = tableRows.length;

for (var x=rowCount-1; x>=0; x--) {
   elmtTable.removeChild(tableRows[x]);
}
	for (i = 0; i < myTasks.length; i++) { 
		var table = document.getElementById("myTable");
    	var row = table.insertRow(i);
    	var cell1 = row.insertCell(0);
    	var cell2 = row.insertCell(1);
		var cell3 = row.insertCell(2);
    	var cell4 = row.insertCell(3);
		var cell5 = row.insertCell(4);
    	cell1.innerHTML = myTasks[i].taskI;
    	cell2.innerHTML = myTasks[i].taskDesc;
		cell3.innerHTML = myTasks[i].taskPrior;
    	cell4.innerHTML = myTasks[i].taskDate;
		cell5.innerHTML = '<input type="button" class="btn btn-danger" value = "Delete" onClick="Javacsript:deleteRow(this)">';
		
		var keyinput = "taskStorage";
		
		if(typeof(window.localStorage) != 'undefined'){ 			                 
		window.localStorage.setItem(keyinput,JSON.stringify(myTasks)); 	} 	
		else{ 		
		alert("window.localStorage, not defined"); 	
	}
		
}	
}

</script>
</body>
</html>
